import{a,o as r,b as o,w as u,g as l,B as t}from"./runtime-core.esm-bundler.b1f35d24.js";var n={};const c=l("div",{class:"markdown-body"},[l("blockquote",null,[l("p",null,[t("Permissions, validation, and the API\u2019s "),l("code",{class:""},"filter"),t(" parameter all rely on a specific JSON structure to define their rules. This page describes the syntax for creating flat, relational, or complex filter rules.")])]),l("p",null,[l("div",{class:"table-of-contents"},[l("ul",null,[l("li",null,[l("a",{href:"#syntax"},"Syntax")]),l("li",null,[l("a",{href:"#filter-operators"},"Filter Operators")]),l("li",null,[l("a",{href:"#relational"},"Relational")]),l("li",null,[l("a",{href:"#logical-operators"},"Logical Operators")]),l("li",null,[l("a",{href:"#dynamic-variables"},"Dynamic Variables")])])])]),l("h2",{id:"syntax"},[t("Syntax "),l("a",{class:"header-anchor",href:"#syntax"},"#")]),l("ul",null,[l("li",null,[l("strong",null,"Field"),t(" \u2014 Any valid root field, "),l("a",{href:"#relational"},"relational field"),t(", or "),l("a",{href:"#logical-operators"},"logical operator")]),l("li",null,[l("strong",null,"Operator"),t(" \u2014 Any valid "),l("a",{href:"#filter-operators"},"filter operator")]),l("li",null,[l("strong",null,"Value"),t(" \u2014 Any valid static value, or "),l("a",{href:"#dynamic-variables"},"dynamic variable")])]),l("pre",null,[l("code",{class:""},`{
	<field>: {
		<operator>: <value>
	}
}
`)]),l("h3",{id:"examples"},[t("Examples "),l("a",{class:"header-anchor",href:"#examples"},"#")]),l("pre",null,[l("code",{class:"language-json"},[t(`{
	`),l("span",{class:"hljs-attr"},'"title"'),t(`: {
		`),l("span",{class:"hljs-attr"},'"_contains"'),t(": "),l("span",{class:"hljs-string"},'"Directus"'),t(`
	}
}
`)])]),l("pre",null,[l("code",{class:"language-json"},[t(`{
	`),l("span",{class:"hljs-attr"},'"owner"'),t(`: {
		`),l("span",{class:"hljs-attr"},'"_eq"'),t(": "),l("span",{class:"hljs-string"},'"$CURRENT_USER"'),t(`
	}
}
`)])]),l("pre",null,[l("code",{class:"language-json"},[t(`{
	`),l("span",{class:"hljs-attr"},'"datetime"'),t(`: {
		`),l("span",{class:"hljs-attr"},'"_lte"'),t(": "),l("span",{class:"hljs-string"},'"$NOW"'),t(`
	}
}
`)])]),l("h2",{id:"filter-operators"},[t("Filter Operators "),l("a",{class:"header-anchor",href:"#filter-operators"},"#")]),l("table",null,[l("thead",null,[l("tr",null,[l("th",null,[t("Operator Title "),l("em",null,"(in app)")]),l("th",null,"Operator"),l("th",null,"Description")])]),l("tbody",null,[l("tr",null,[l("td",null,"Equals"),l("td",null,[l("code",{class:""},"_eq")]),l("td",null,"Equal to")]),l("tr",null,[l("td",null,"Doesn\u2019t equal"),l("td",null,[l("code",{class:""},"_neq")]),l("td",null,"Not equal to")]),l("tr",null,[l("td",null,"Less than"),l("td",null,[l("code",{class:""},"_lt")]),l("td",null,"Less than")]),l("tr",null,[l("td",null,"Less than or equal to"),l("td",null,[l("code",{class:""},"_lte")]),l("td",null,"Less than or equal to")]),l("tr",null,[l("td",null,"Greater than"),l("td",null,[l("code",{class:""},"_gt")]),l("td",null,"Greater than")]),l("tr",null,[l("td",null,"Greater than or equal to"),l("td",null,[l("code",{class:""},"_gte")]),l("td",null,"Greater than or equal to")]),l("tr",null,[l("td",null,"Is one of"),l("td",null,[l("code",{class:""},"_in")]),l("td",null,"Matches any of the values")]),l("tr",null,[l("td",null,"Is not one of"),l("td",null,[l("code",{class:""},"_nin")]),l("td",null,"Doesn\u2019t match any of the values")]),l("tr",null,[l("td",null,"Is null"),l("td",null,[l("code",{class:""},"_null")]),l("td",null,[t("Is "),l("code",{class:""},"null")])]),l("tr",null,[l("td",null,"Isn\u2019t null"),l("td",null,[l("code",{class:""},"_nnull")]),l("td",null,[t("Is not "),l("code",{class:""},"null")])]),l("tr",null,[l("td",null,"Contains"),l("td",null,[l("code",{class:""},"_contains")]),l("td",null,"Contains the substring")]),l("tr",null,[l("td",null,"Doesn\u2019t contain"),l("td",null,[l("code",{class:""},"_ncontains")]),l("td",null,"Doesn\u2019t contain the substring")]),l("tr",null,[l("td",null,"Starts with"),l("td",null,[l("code",{class:""},"_starts_with")]),l("td",null,"Starts with")]),l("tr",null,[l("td",null,"Doesn\u2019t start with"),l("td",null,[l("code",{class:""},"_nstarts_with")]),l("td",null,"Doesn\u2019t start with")]),l("tr",null,[l("td",null,"Ends with"),l("td",null,[l("code",{class:""},"_ends_with")]),l("td",null,"Ends with")]),l("tr",null,[l("td",null,"Doesn\u2019t end with"),l("td",null,[l("code",{class:""},"_nends_with")]),l("td",null,"Doesn\u2019t end with")]),l("tr",null,[l("td",null,"Is between"),l("td",null,[l("code",{class:""},"_between")]),l("td",null,"Is between two values (inclusive)")]),l("tr",null,[l("td",null,"Isn\u2019t between"),l("td",null,[l("code",{class:""},"_nbetween")]),l("td",null,"Is not between two values (inclusive)")]),l("tr",null,[l("td",null,"Is empty"),l("td",null,[l("code",{class:""},"_empty")]),l("td",null,[t("Is empty ("),l("code",{class:""},"null"),t(" or falsy)")])]),l("tr",null,[l("td",null,"Isn\u2019t empty"),l("td",null,[l("code",{class:""},"_nempty")]),l("td",null,[t("Is not empty ("),l("code",{class:""},"null"),t(" or falsy)")])]),l("tr",null,[l("td",null,"Intersects"),l("td",null,[l("code",{class:""},"_intersects"),t(),l("sup",null,"[1]")]),l("td",null,"Value intersects a given point")]),l("tr",null,[l("td",null,"Doesn\u2019t intersect"),l("td",null,[l("code",{class:""},"_nintersects"),t(),l("sup",null,"[1]")]),l("td",null,"Value does not intersect a given point")]),l("tr",null,[l("td",null,"Intersects Bounding box"),l("td",null,[l("code",{class:""},"_intersects_bbox"),t(),l("sup",null,"[1]")]),l("td",null,"Value is in a bounding box")]),l("tr",null,[l("td",null,"Doesn\u2019t intersect bounding box"),l("td",null,[l("code",{class:""},"_nintersects_bbox"),t(),l("sup",null,"[1]")]),l("td",null,"Value is not in a bounding box")])])]),l("p",null,[t("The following operator has no Title on the Filter Interface as it is "),l("strong",null,"only available in validation permissions"),t(":")]),l("table",null,[l("thead",null,[l("tr",null,[l("th",null,"Operator"),l("th",null,"Description")])]),l("tbody",null,[l("tr",null,[l("td",null,[l("code",{class:""},"_regex"),t(),l("sup",null,"[2]")]),l("td",null,"Field has to match regex")])])]),l("p",null,[l("sup",null,"[1]"),t(" Only available on Geometry types."),l("br"),l("sup",null,"[2]"),t(" JavaScript \u201Cflavor\u201D regex. Make sure to escape backslashes.")]),l("h2",{id:"relational"},[t("Relational "),l("a",{class:"header-anchor",href:"#relational"},"#")]),l("p",null,[t("You can target related values by nesting field names. For example, if you have a relational Many-to-One "),l("code",{class:""},"author"),t(" field, you can set a rule for the "),l("code",{class:""},"author.name"),t(" field using the following syntax.")]),l("pre",null,[l("code",{class:"language-json"},[t(`{
	`),l("span",{class:"hljs-attr"},'"author"'),t(`: {
		`),l("span",{class:"hljs-attr"},'"name"'),t(`: {
			`),l("span",{class:"hljs-attr"},'"_eq"'),t(": "),l("span",{class:"hljs-string"},'"Rijk van Zanten"'),t(`
		}
	}
}
`)])]),l("h2",{id:"logical-operators"},[t("Logical Operators "),l("a",{class:"header-anchor",href:"#logical-operators"},"#")]),l("p",null,[t("You can nest or group multiple rules using the "),l("code",{class:""},"_and"),t(" or "),l("code",{class:""},"_or"),t(" logical operators. Each logical operator holds an array of Filter Rules, allowing for more complex filtering. Also note in the example that Logical Operators can be sub-nested into Logical Operators. However, they cannot be sub-nested into Filter Rules.")]),l("pre",null,[l("code",{class:"language-json"},[t(`{
	`),l("span",{class:"hljs-attr"},'"_or"'),t(`: [
		{
			`),l("span",{class:"hljs-attr"},'"_and"'),t(`: [
				{
					`),l("span",{class:"hljs-attr"},'"user_created"'),t(`: {
						`),l("span",{class:"hljs-attr"},'"_eq"'),t(": "),l("span",{class:"hljs-string"},'"$CURRENT_USER"'),t(`
					}
				},
				{
					`),l("span",{class:"hljs-attr"},'"status"'),t(`: {
						`),l("span",{class:"hljs-attr"},'"_in"'),t(": ["),l("span",{class:"hljs-string"},'"published"'),t(", "),l("span",{class:"hljs-string"},'"draft"'),t(`]
					}
				}
			]
		},
		{
			`),l("span",{class:"hljs-attr"},'"_and"'),t(`: [
				{
					`),l("span",{class:"hljs-attr"},'"user_created"'),t(`: {
						`),l("span",{class:"hljs-attr"},'"_neq"'),t(": "),l("span",{class:"hljs-string"},'"$CURRENT_USER"'),t(`
					}
				},
				{
					`),l("span",{class:"hljs-attr"},'"status"'),t(`: {
						`),l("span",{class:"hljs-attr"},'"_in"'),t(": ["),l("span",{class:"hljs-string"},'"published"'),t(`]
					}
				}
			]
		}
	]
}
`)])]),l("h3",{id:"some-vs-none-in-one-to-many"},[t("Some vs None in One-to-Many "),l("a",{class:"header-anchor",href:"#some-vs-none-in-one-to-many"},"#")]),l("p",null,"When applying filters to a one-to-many field, Directus will default to a \u201Csome\u201D search, for example in:"),l("pre",null,[l("code",{class:"language-json"},[t(`{
	`),l("span",{class:"hljs-attr"},'"categories"'),t(`: {
		`),l("span",{class:"hljs-attr"},'"name"'),t(`: {
			`),l("span",{class:"hljs-attr"},'"_eq"'),t(": "),l("span",{class:"hljs-string"},'"Recipe"'),t(`
		}
	}
}
`)])]),l("p",null,[t("the top level parent will be returned if "),l("em",null,"one of"),t(" the categories has the name "),l("code",{class:""},"Recipe"),t(". This behavior can be overridden by using the explicit "),l("code",{class:""},"_some"),t(" and "),l("code",{class:""},"_none"),t(" operators, for example:")]),l("pre",null,[l("code",{class:"language-json"},[t(`{
	`),l("span",{class:"hljs-attr"},'"categories"'),t(`: {
		`),l("span",{class:"hljs-attr"},'"_none"'),t(`: {
			`),l("span",{class:"hljs-attr"},'"name"'),t(`: {
				`),l("span",{class:"hljs-attr"},'"_eq"'),t(": "),l("span",{class:"hljs-string"},'"Recipe"'),t(`
			}
		}
	}
}
`)])]),l("p",null,"will fetch all parent items that don\u2019t have the category \u201CRecipe\u201D"),l("h2",{id:"dynamic-variables"},[t("Dynamic Variables "),l("a",{class:"header-anchor",href:"#dynamic-variables"},"#")]),l("p",null,[t("In addition to static values, you can also filter against "),l("em",null,"dynamic"),t(" values using the following variables.")]),l("ul",null,[l("li",null,[l("code",{class:""},"$CURRENT_USER"),t(" \u2014 The primary key of the currently authenticated user")]),l("li",null,[l("code",{class:""},"$CURRENT_ROLE"),t(" \u2014 The primary key of the role for the currently authenticated user")]),l("li",null,[l("code",{class:""},"$NOW"),t(" \u2014 The current timestamp")]),l("li",null,[l("code",{class:""},"$NOW(<adjustment>)"),t(" - The current timestamp plus/minus a given distance, for example "),l("code",{class:""},"$NOW(-1 year)"),t(", "),l("code",{class:""},"$NOW(+2 hours)")])]),l("div",{class:"tip hint"},[l("div",{class:"hint-title"},"Nested User / Role variables in Permissions"),l("p",null,[t("When configuring permissions, "),l("code",{class:""},"$CURRENT_USER"),t(" and "),l("code",{class:""},"$CURRENT_ROLE"),t(" allow you to specify any (nested) field under the current user/role as well as the root ID. For example: "),l("code",{class:""},"$CURRENT_ROLE.name"),t(" or "),l("code",{class:""},"$CURRENT_USER.avatar.filesize"),t(". This includes custom fields that were added to the directus_users/directus_roles tables.")]),l("p",null,"Note: This feature is only available for permissions, validation, and presets. Regular filters and conditional fields currently only support the root ID.")])],-1),i={title:"Filter Rules",modularExtension:!1},d={name:"filter-rules",setup(h,{expose:s}){return s({frontmatter:{title:"Filter Rules",modularExtension:!1}}),(p,f)=>{const e=a("docswrapper");return r(),o(e,{frontmatter:i},{default:u(()=>[c]),_:1})}}};typeof n=="function"&&n(d);export{d as default,i as frontmatter};
